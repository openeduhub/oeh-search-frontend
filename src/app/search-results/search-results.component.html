<div class="summary">
  <div class="no-results" *ngIf="results.hits.total === 0">
    <ng-container i18n>No results</ng-container>
    <div>
      <a
        *ngIf="filterCount > 0"
        mat-flat-button
        color="primary"
        routerLink="/search"
        [queryParams]="{ filters: null }"
        queryParamsHandling="merge"
        i18n
        >Search without filters</a
      >
    </div>
  </div>
  <ng-container *ngIf="results.hits.total > 0">
    <ng-container *ngIf="pageInfo.pageIndex === 0" i18n>
      {results.hits.total, plural, =1 {1 result} other {{{results.hits.total | number}} results}}
    </ng-container>
    <ng-container *ngIf="pageInfo.pageIndex > 0" i18n>
      Page {{ pageInfo.pageIndex + 1 }} of {{ results.hits.total | number }} results
    </ng-container>
    <ng-container i18n>({{ results.took / 1000 | number }} seconds)</ng-container>
  </ng-container>
</div>

<ng-container *ngIf="results.hits.total > 0">
  <div class="results">
    <div class="result" *ngFor="let result of results.hits.hits">
      <mat-card>
        <a class="details-link" [routerLink]="['/details', result.id]">
          <div class="image-container" mat-card-image>
            <div class="image">
              <img
                class="img-bg"
                *ngIf="result.thumbnail"
                [src]="
                  result.thumbnail.large || result.thumbnail.small
                    | safeBase64Data: result.thumbnail.mimetype
                "
              />
              <img
                class="img-main"
                *ngIf="result.thumbnail"
                [src]="
                  result.thumbnail.large || result.thumbnail.small
                    | safeBase64Data: result.thumbnail.mimetype
                "
              />
            </div>
          </div>
          <mat-card-title>{{ result.lom.general.title | truncate: 52 }}</mat-card-title>
        </a>
        <div class="top-infos">
          <div
            class="editorial"
            *ngIf="result | editorial"
            i18n-matTooltip
            matTooltipPosition="left"
            matTooltip="Recommended by editorial team"
          >
            <img src="assets/images/editorial.svg" />
          </div>
          <div
            class="oer"
            *ngIf="result.license?.oer === 'ALL'"
            i18n-matTooltip
            matTooltipPosition="left"
            matTooltip="Open Educational Resources"
          >
            <img src="assets/images/oer.svg" />
          </div>
        </div>
        <mat-card-content>
          <p class="description" *ngIf="result.lom.educational?.description">
            {{ result.lom.educational.description | trim | truncate: 120 }}
          </p>
          <div class="educational" *ngIf="result.valuespaces?.discipline">
            <label><mat-icon>book_icon</mat-icon> </label>
            <div>
              <span *ngFor="let discipline of result.valuespaces.discipline | slice: 0:5">
                <a
                  routerLink="/search"
                  [queryParams]="['disciplines', [discipline.de]] | generateFilters: filters"
                  queryParamsHandling="merge"
                >
                  {{ discipline.de }}
                  <!-- @TODO: use i18n de/en -->
                </a>
              </span>
            </div>
          </div>
          <div class="context" *ngIf="result.valuespaces?.educationalContext">
            <label><mat-icon>school</mat-icon> </label>
            <div>
              <span *ngFor="let context of result.valuespaces.educationalContext">
                <a
                  routerLink="/search"
                  [queryParams]="['educationalContexts', [context.de]] | generateFilters: filters"
                  queryParamsHandling="merge"
                >
                  {{ context.de }}
                  <!-- @TODO: use i18n de/en -->
                </a>
              </span>
            </div>
          </div>
          <div class="lrt" *ngIf="result.valuespaces?.learningResourceType">
            <label>
              <mat-icon>photo_library</mat-icon>
            </label>
            <div>
              <span *ngFor="let lrt of result.valuespaces.learningResourceType">
                <a
                  routerLink="/search"
                  [queryParams]="['learningResourceTypes', [lrt.de]] | generateFilters: filters"
                  queryParamsHandling="merge"
                >
                  {{ lrt.de }}
                </a>
              </span>
            </div>
          </div>
          <div class="keyword" *ngIf="result.lom.general.keyword">
            <label><mat-icon>list</mat-icon></label>
            <div>
              <span *ngFor="let keyword of result.lom.general.keyword | slice: 0:5">
                <a
                  routerLink="/search"
                  [queryParams]="['keywords', [keyword]] | generateFilters: filters"
                  queryParamsHandling="merge"
                >
                  {{ keyword }}
                </a>
              </span>
            </div>
          </div>
          <a class="details-button" [routerLink]="['/details', result.id]"
            ><mat-icon>info</mat-icon> <span i18n>More Information</span></a
          >
        </mat-card-content>
        <a
          class="content-link"
          mat-flat-button
          color="primary"
          target="_blank"
          [href]="result.lom.technical.location"
          [ngSwitch]="result.type"
        >
          <ng-container i18n *ngSwitchCase="'MATERIAL'">Go To Content</ng-container>
          <ng-container i18n *ngSwitchCase="'TOOL'">Go To Tool</ng-container>
          <ng-container i18n *ngSwitchCase="'SOURCE'">Go To Source</ng-container>
        </a>
        <a class="source" [href]="result.source.url" target="_blank">
          <ng-container i18n>Source</ng-container>: {{ result.source.name }}</a
        >
      </mat-card>
    </div>
  </div>
  <mat-paginator
    [length]="results.hits.total"
    [pageIndex]="pageInfo.pageIndex"
    [pageSize]="pageInfo.pageSize"
    (page)="onPage($event)"
  >
  </mat-paginator>
</ng-container>
