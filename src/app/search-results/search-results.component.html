<div class="summary">
  <ng-container *ngIf="results.total === 0" i18n>No results</ng-container>
  <ng-container *ngIf="results.total > 0">
    <ng-container *ngIf="pageInfo.pageIndex === 0" i18n>
      {results.total, plural, =1 {1 result} other {{{results.total | number}} results}}
    </ng-container>
    <ng-container *ngIf="pageInfo.pageIndex > 0" i18n>
      Page {{ pageInfo.pageIndex + 1 }} of {{ results.total | number }} results
    </ng-container>
    <ng-container i18n>({{ results.time / 1000 | number }} seconds)</ng-container>
  </ng-container>
</div>

<ng-container *ngIf="results.total > 0">
  <div class="results">
    <mat-card class="result" *ngFor="let result of results.results">
      <a class="details-link" [routerLink]="['/details', result.id]">
        <img
          *ngIf="result.thumbnail"
          mat-card-image
          [src]="
            result.thumbnail.large || result.thumbnail.small
              | safeBase64Data: result.thumbnail.mimetype
          "
        />
        <mat-card-title>{{ result.lom.general.title | truncate: 52 }}</mat-card-title>
      </a>
      <mat-card-content>
        <p>
          {{ result.lom.educational.description?.trim() | truncate: 120 }}
        </p>
        <div class="educational" *ngIf="result.valuespaces && result.valuespaces.discipline">
          <label i18n>Discipline</label>
          <span *ngFor="let discipline of result.valuespaces.discipline">
            <a
              routerLink
              [queryParams]="['disciplines', [discipline.de]] | generateFilters: filters"
              queryParamsHandling="merge"
            >
              {{ discipline.de }}
              <!-- @TODO: use i18n de/en -->
            </a>
          </span>
        </div>
        <div class="context" *ngIf="result.valuespaces && result.valuespaces.educationalContext">
          <label i18n>Educational Context</label>
          <span *ngFor="let context of result.valuespaces.educationalContext">
            <a
              routerLink
              [queryParams]="['educationalContexts', [context.de]] | generateFilters: filters"
              queryParamsHandling="merge"
            >
              {{ context.de }}
              <!-- @TODO: use i18n de/en -->
            </a>
          </span>
        </div>
        <div class="keyword" *ngIf="result.lom.general.keyword">
          <label i18n>Keywords</label>
          <span *ngFor="let keyword of result.lom.general.keyword | slice: 0:5">
            <a
              routerLink
              [queryParams]="['keywords', [keyword]] | generateFilters: filters"
              queryParamsHandling="merge"
            >
              {{ keyword }}
            </a>
          </span>
        </div>
      </mat-card-content>
      <a class="source" [href]="result.source.url" target="_blank">{{ result.source.name }}</a>
      <a
        class="content-link"
        mat-icon-button
        i18n-aria-label
        aria-label="Go to content"
        i18n-matTooltip
        matTooltip="Go to content"
        [href]="result.lom.technical.location"
      >
        <mat-icon>open_in_new</mat-icon>
      </a>
    </mat-card>
  </div>
  <mat-paginator
    [length]="results.total"
    [pageIndex]="pageInfo.pageIndex"
    [pageSize]="pageInfo.pageSize"
    (page)="onPage($event)"
  >
  </mat-paginator>
</ng-container>
