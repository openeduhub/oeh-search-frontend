<form (ngSubmit)="onSubmit()">
  <mat-form-field appearance="outline" id="search-input">
    <!-- <mat-label>Search</mat-label> -->
    <input
      matInput
      [formControl]="searchField"
      autofocus
      [matAutocomplete]="auto"
      #autoComplete="matAutocompleteTrigger"
      placeholder="Search"
    />
    <button matSuffix mat-icon-button type="submit" aria-label="Search">
      <mat-icon>search</mat-icon>
    </button>
  </mat-form-field>
  <mat-autocomplete #auto="matAutocomplete" (optionSelected)="onAutocompleteSelected($event)">
    <mat-option *ngFor="let option of autoCompleteSuggestions$ | async" [value]="option">{{
      option
    }}</mat-option>
  </mat-autocomplete>
  <div *ngIf="facets" class="filters" [formGroup]="facetFilters">
    <mat-form-field *ngFor="let facet of facets | keyvalue">
      <mat-label>{{ facet.key }}</mat-label>
      <mat-select [formControlName]="facet.key" multiple>
        <mat-option *ngFor="let bucket of facet.value.buckets" [value]="bucket.key">
          {{ bucket.key }} ({{ bucket.doc_count }})
        </mat-option>
      </mat-select>
    </mat-form-field>
  </div>
</form>

<div *ngIf="results && !results.total" class="results">
  No results.
</div>

<p *ngIf="results?.didYouMeanSuggestion" class="did-you-mean">
  Did you mean:
  <a
    [innerHTML]="results.didYouMeanSuggestion.html"
    routerLink="/search/{{ results.didYouMeanSuggestion.plain }}"
  ></a>
</p>

<ng-container *ngIf="results?.total">
  <div class="results">
    <div class="result" *ngFor="let result of results.results">
      <div class="title">
        <a [routerLink]="['/details', result.id]">
          {{ result.lom.general.title }}
        </a>
      </div>
      <div class="description">
        {{ result.fulltext | truncate: 300 }}
      </div>
      <div class="keyword">
        <a
          routerLink
          [queryParams]="['Keywords', [result.lom.general.keyword]] | generateFilters: filters"
          queryParamsHandling="merge"
        >
          {{ result.lom.general.keyword }}
        </a>
      </div>
      <div class="source">
        {{ result.source.name }}
      </div>
    </div>
  </div>
  <mat-paginator
    [length]="results.total"
    [pageIndex]="pageInfo.pageIndex"
    [pageSize]="pageInfo.pageSize"
    [pageSizeOptions]="[5, 10, 25, 100]"
    (page)="onPage($event)"
  >
  </mat-paginator>
</ng-container>
